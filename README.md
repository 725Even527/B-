📺 Bilibili 弹幕数据抓取与分析可视化工具

本项目提供从Bilibili视频搜索结果中批量抓取弹幕数据，并进行中文分词、TF-IDF关键词提取、词频统计和情感分析，最终生成交互式的可视化HTML页面展示分析结果。

✨ 项目功能概览

🔍 弹幕数据爬取

根据关键词（如“俄乌冲突”）搜索 Bilibili 视频。
自动提取视频 BV 号和 CID，抓取弹幕数据（XML 格式）。
支持指定最大爬取页数，过滤播放量低于一定值的视频（如10000+播放）。
将弹幕信息保存为结构化 Excel 文件。

📊 数据处理与分析
清洗无效弹幕，去重与长度过滤。
使用 jieba 进行中文分词，加载自定义词典与停用词表。
提取 TF-IDF 关键词。
统计词频并生成 Top20 高频词。
使用预训练模型 uer/roberta-base-finetuned-jd-binary-chinese 进行情感分类。

🌐 可视化展示
生成词云图、词频柱状图等静态图像。
自动生成一个美观、交互性强的 HTML 页面展示分析结果，包含：
高频词柱状图（支持鼠标悬浮）
词云图（PNG/JPG）
TF-IDF 表格（可排序）
情感分析统计图（饼图/条形图）

(1)
📥 弹幕爬取脚本（爬取.py）说明

该脚本用于从Bilibili自动搜索并下载与指定关键词相关视频的弹幕数据，并保存为 Excel 文件，便于后续分析。

---

### 🔧 功能概述

* 自动搜索关键词相关视频
* 提取视频 BV 号 和 弹幕数据
* 保存为单个或合并的 Excel 文件

---

### 🚀 快速使用指南

#### 1️⃣ 安装依赖（首次使用）

```bash
pip install requests beautifulsoup4 pandas openpyxl
```

#### 2️⃣ 修改关键词

打开脚本顶部，找到这行：

```python
KEYWORD = "Python"
```

将其中的关键词替换为你感兴趣的内容，例如 `"人工智能"`。

#### 3️⃣ 运行脚本

```bash
python danmaku_crawler.py
```

#### 4️⃣ 输出文件位置

* 单个视频弹幕：保存在 `danmakus/` 文件夹
* 所有弹幕合并表：保存在 `output/combined_danmakus_all.xlsx`

---

### 📌 注意事项

* 脚本每次运行会抓取多个视频，过程较慢请耐心等待
* 若部分视频无弹幕或受限，脚本会自动跳过

---

如需后续分析与可视化，请继续使用后续脚本进行处理。是否需要我也帮你写“分析脚本”和“可视化脚本”的简洁说明？

📁 输出说明
程序运行后会生成以下文件夹和文件：
```
├── danmakus/
│   ├── danmakus_BVxxxxx.xlsx   # 每个视频的弹幕 Excel 文件
├── output/
│   └── combined_danmakus_all.xlsx  # 所有弹幕合并后的总表
```

你只需关注 `output/combined_danmakus_all.xlsx`，它是后续分析的主要输入文件。

常见问题

| 问题                   | 解决方法                 |
| -------------------- | -------------------- |
| 显示“跳过 BVxxxx：未取到CID” | 该视频可能是付费或受限视频，跳过无影响  |
| 返回非XML，跳过            | 视频可能没有弹幕或格式异常，自动跳过   |
| 无法访问B站               | 确保网络连接正常，没有被防火墙或代理阻断 |
| 文件未生成                | 检查是否有视频弹幕，或是否修改了保存路径 |

🧩 高级可选修改（可跳过）
如果你想保存路径不一样，可以修改：
```python
TMP_DIR = "../danmakus"   # 改成你喜欢的文件夹路径
OUT_DIR = "../output"     # 改成你希望的输出路径
```

 ❤️ 后续步骤
完成爬取后，可以继续使用我们提供的分析和可视化脚本，对弹幕内容进行深入挖掘与展示。

